!function(){"use strict";function e(e,t,n){function r(e,t,n){e.appendChild(t)}function i(){var e=document.createElement("form");return e.className="brutusin-form",e.onsubmit=function(e){return!1},e}function a(e){if(!c.factories.schemaResolver)throw"SchemaResolver factory not registered";var t=new c.factories.schemaResolver;return e&&e.customSchemaResolver&&(t.resolveSchemas=e.customSchemaResolver),t}function o(e){var t={};for(var n in c.factories.typeComponents){if(!c.factories.typeComponents[n])throw"TypeComponent factory not registered for type '"+n+"'";t[n]=c.factories.typeComponents[n]}return t}function s(e,t,n){var r=function(i){if(i)if(i.hasOwnProperty("type")){if(!d.hasOwnProperty(i.type))throw"Component factory not found for schemas of type '"+i.type+"'";var a=new d[i.type];a.init(e,t,m),u.removeListener(e,r),n(a)}else{if(!i.hasOwnProperty("oneOf"))throw"Component factory not found a valid schema for id '"+e+"'";var a=new d.oneOf;a.init(e,t,m),u.removeListener(e,r),n(a)}};u.addListener(e,r)}this.schema=e,this.initialData=t;var l;this.getData=function(){return l?l.getData():this.initialData};var u=a(n);u.init(this);var d=o(n),p=i();this.getDOM=function(){return p};var m={schemaResolver:u,createTypeComponent:s,appendChild:r};s("$",t,function(e){l=e,r(p,e.getDOM())})}function t(){this.translations={},this.setTranslations=function(e){if(!e)throw"A translation map is required";this.translations=e},this.getTranslation=function(e){return this.translations[e]?this.translations[e]:"{$"+e+"}"}}function n(){function e(e){return e}function t(e,t){for(var n in r)if(n.startsWith(e)&&!t.hasOwnProperty(n)){var a=i[n];if(a)for(var o=0;o<a.length;o++)a[o](null);delete r[n]}}function n(e,t,n){function r(e,t){if(e)if(t(e),e.hasOwnProperty("oneOf"))for(var n in e.oneOf)r(e.oneOf[n],t);else if(e.hasOwnProperty("$ref")){var i=d(e.$ref);r(i,t)}else if("object"===e.type){if(e.properties){e.hasOwnProperty("required")&&Array.isArray(e.required)&&(e.requiredProperties=e.required,delete e.required);for(var a in e.properties)r(e.properties[a],t)}if(e.patternProperties)for(var o in e.patternProperties){var s=e.patternProperties[o];(s.hasOwnProperty("type")||s.hasOwnProperty("$ref")||s.hasOwnProperty("oneOf"))&&r(e.patternProperties[o],t)}e.additionalProperties&&(e.additionalProperties.hasOwnProperty("type")||e.additionalProperties.hasOwnProperty("oneOf"))&&r(e.additionalProperties,t)}else"array"===e.type&&r(e.items,t)}function i(e){r(e,function(e){"object"===e.type&&e.properties&&e.hasOwnProperty("required")&&Array.isArray(e.required)&&(e.requiredProperties=e.required,delete e.required)})}function a(e){r(e,function(e){if("object"===e.type&&e.additionalProperties){e.hasOwnProperty("patternProperties")||(e.patternProperties={});var t=!1;for(var n in e.patternProperties)if(".*"===n){t=!0;break}t||(e.patternProperties[".*"]=e.additionalProperties,delete e.additionalProperties)}})}function o(e,t){function r(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1}var i=u(t);if(p[e]={id:e,schema:i,"static":!n},t){if(t.hasOwnProperty("oneOf")){i.oneOf=new Array,i.type="oneOf";for(var a in t.oneOf){var s=e+"."+a;i.oneOf[a]=s,o(s,t.oneOf[a])}}else if(t.hasOwnProperty("$ref")){var c=d(t.$ref);if(c){if(t.hasOwnProperty("title")||t.hasOwnProperty("description")){var f={};for(var h in c)f[h]=c[h];t.hasOwnProperty("title")&&(f.title=t.title),t.hasOwnProperty("description")&&(f.description=t.description),c=f}o(e,c)}}else if("object"===t.type){if(t.properties){i.properties={};for(var h in t.properties){var s=e+"."+h;i.properties[h]=s;var v=t.properties[h];t.requiredProperties&&(r(t.requiredProperties,h)?v.required=!0:v.required=!1),o(s,v)}}if(t.patternProperties){i.patternProperties={};for(var y in t.patternProperties){var g=e+"[/"+y+"/]";i.patternProperties[y]=g;var _=t.patternProperties[y];_.hasOwnProperty("type")||_.hasOwnProperty("$ref")||_.hasOwnProperty("oneOf")?o(g,t.patternProperties[y]):o(g,l)}}}else"array"===t.type&&(i.items=e+"[#]",o(i.items,t.items));if(t.hasOwnProperty("dependsOn")){null===t.dependsOn&&(t.dependsOn=["$"]);for(var O=new Array,a=0;a<t.dependsOn.length;a++)t.dependsOn[a]?t.dependsOn[a].startsWith("$")?O[a]=t.dependsOn[a]:e.endsWith("]")?O[a]=e+"."+t.dependsOn[a]:O[a]=e.substring(0,e.lastIndexOf("."))+"."+t.dependsOn[a]:O[a]="$";p[e].dependsOn=O;for(var a=0;a<O.length;a++){var b=m[O[a]];b||(b=new Array,m[O[a]]=b),b[b.length]=e}}}}function s(){function e(t,n,r){if(n.hasOwnProperty(r))throw"Schema dependency graph has cycles";if(n[r]=null,!t.hasOwnProperty(r)){t[r]=null;var i=m[r];if(i)for(var a=0;a<i.length;a++)e(t,n,i[a]);delete n[r]}}var t=new Object;for(var n in m)t.hasOwnProperty(n)||e(t,new Object,n)}function c(){for(var e in m){if(!p.hasOwnProperty(e))throw"Invalid schema id found in dependecies: "+e;p[e].dependedBy=m[e]}}function u(e){var t={};for(var n in e)"items"!==n&&"properties"!==n&&"additionalProperties"!==n&&("pattern"===n?t[n]=new RegExp(e[n]):t[n]=e[n]);return t}function d(e){var n=e.split("/"),r=t;for(var i in n)"0"!==i&&(r=r[n[i]]);return r}var p={},m={};return i(t),a(t),o(e,t),s(),c(),p}var r,i={};this.init=function(e){this.form=e,r=n("$",e.schema,!1)},this.notifyChanged=function(e){if(r.hasOwnProperty(e)){var t=r[e].dependedBy;if(!t)return;this.resolve(t,i)}},this.resolve=function(e,i){this.resolveSchemas(e,this.form.getData(),function(a){if(!a)throw"Couldn't resolve schema item '"+o+"'";for(var o in a)if(e.includes(o)&&(!r.hasOwnProperty(o)||JSON.stringify(r[o].schema)!==JSON.stringify(a[o]))){var s=n(o,a[o],!0);t(o,s);for(var c in s){r[c]=s[c];var l=i[c];if(l)for(var u=0;u<l.length;u++)l[u](s[c].schema)}}})},this.addListener=function(t,n){if(t=e(t),i.hasOwnProperty(t)?i[t].push(n):i[t]=[n],r.hasOwnProperty(t))if(r[t].dependsOn){var a={};a[t]=[n],this.resolve(t,a)}else n(r[t].schema);else;},this.removeListener=function(t,n){if(t=e(t),i.hasOwnProperty(t))for(var r=i[t],a=0;a<r.length;a++)if(r[a]===n){r.splice(a,1);break}},this.resolveSchemas=function(e,t,n){}}function r(){this.init=function(e,t,n){var r=this;r._||(r._={},r._.dom=document.createElement("div")),r._.children={},r._.schemaListeners=[],r._.schema=null,e&&(r._.schemaId=e),"undefined"!=typeof t&&(r._.initialData=t),n&&(r._.appendChild=n.appendChild,r._.createTypeComponent=n.createTypeComponent,r._.registerSchemaListener=function(e,t){r._.schemaListeners.push({schemaId:e,callback:t}),n.schemaResolver.addListener(e,t)},r._.unRegisterSchemaListener=function(e,t){for(var i,a=0;a<r._.schemaListeners.length;a++)if(i=r._.schemaListeners[a],i.schemaId===e&&i.callback===t){r._.schemaListeners.splice(a,1);break}n.schemaResolver.removeListener(e,t)},r._.notifyChanged=function(e){n.schemaResolver.notifyChanged(e)},r._.removeAllChildren=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}),r._.removeAllChildren(r._.dom),r._.registerSchemaListener(r._.schemaId,function(e){r._.schema?(r.dispose(),r.init()):(r._.schema=e,e&&r.render(e))})},this.render=function(e){},this.getDOM=function(){return this._.dom},this.getData=function(){},this.validate=function(){},this.onchange=function(){},this.dispose=function(){for(var e=this._.schemaListeners.length-1;e>=0;e--){var t=this._.schemaListeners[e];this._.unRegisterSchemaListener(t.schemaId,t.callback)}for(var n in this._.children)this._.children[n].dispose()}}function i(){this.render=function(e){function t(t,i){var a=document.createElement("tbody"),o=document.createElement("tr");o.className="item";var s=document.createElement("td");s.className="item-index";var c=document.createElement("td");c.className="item-action";var l=document.createElement("td");l.className="item-value";var u=document.createElement("button");u.setAttribute("type","button"),u.className="remove",e.readOnly===!0&&(u.disabled=!0),r(u,document.createTextNode("x"));var d,p=function(){for(var e=0;e<t.rows.length;e++){var n=t.rows[e];n.cells[0].innerHTML=e+1,n.index=e}};n._.createTypeComponent(e.items,i,function(e){d=e,n._.children.push(e),r(l,e.getDOM())}),u.onclick=function(){d&&(d.dispose(),d=null,o.parentNode.removeChild(o),n._.children.splice(o.index,1)),p()},r(c,u);var m=document.createTextNode(t.rows.length+1);r(s,m),r(o,s),r(o,c),r(o,l),r(a,o),r(t,a)}var n=this;n._.children=[];var r=n._.appendChild;e&&this._.registerSchemaListener(n._.schemaId,function(i){var a=document.createElement("div"),o=document.createElement("table");o.className="array";var s=document.createElement("button");if(e.readOnly&&(s.disabled=!0),s.setAttribute("type","button"),s.onclick=function(){t(o)},i.description&&(s.title=i.description),r(s,document.createTextNode(c.i18n.getTranslation("addItem"))),r(a,o),r(a,s),n._.initialData&&n._.initialData instanceof Array)for(var l=0;l<n._.initialData.length;l++)t(o,n._.initialData[l]);r(n.getDOM(),a)})},this.getData=function(){var e=[];for(var t in this._.children){var n=this._.children[t].getData();null!==n&&e.push(n)}return e.length>0?e:null}}function a(){this.render=function(e){function t(e,t,n){var s=document.createElement("tr"),c=RegExp(t),l=function(u){for(;s.firstChild;)s.removeChild(s.firstChild);var d=null;if(d){var p=r._.children[d];p&&(p.dispose(),delete r._.children[d])}if(u&&u.type&&"null"!==u.type){var m,f=document.createElement("td");f.className="add-prop-name";var h=document.createElement("table"),v=document.createElement("tr"),y=document.createElement("td"),g=document.createElement("td"),_=document.createElement("td");_.className="prop-value";var O=document.createElement("input");O.type="text",O.placeholder="/"+t+"/",O.onchange=function(){if(d&&delete r._.children[d],O.value&&-1!==O.value.search(c)){for(var e=O.value,t=1;d!==e&&r._.children.hasOwnProperty(e);)e=O.value+"("+t+")",t++;d=e,O.value=d,r._.children[d]=m}};var b=document.createElement("button");b.setAttribute("type","button"),b.className="remove",i(b,document.createTextNode("x")),b.onclick=function(){d&&delete r._.children[d],m&&(m.dispose(),m=null,s.parentNode.removeChild(s)),r._.unRegisterSchemaListener(e,l)},i(y,O),i(g,b),i(v,y),i(v,g),i(h,v),i(f,h),i(s,f),i(s,_),i(o,s),i(a,o),r._.createTypeComponent(e,n,function(e){m=e,d&&(r._.children[d]=e),i(_,e.getDOM()),e.onchange=function(e){r._.notifyChanged(r._.schemaId),r.onchange(e)}})}};return r._.registerSchemaListener(e,l),s}function n(e,t,n){var a=document.createElement("tr");return r._.registerSchemaListener(e,function(s){for(;a.firstChild;)a.removeChild(a.firstChild);var c=r._.children[t];if(c&&(c.dispose(),delete r._.children[t]),s&&s.type&&"null"!==s.type){var l=document.createElement("td");l.className="prop-name";var u=document.createElement("td");u.className="prop-value",i(o,a),i(a,l),i(l,document.createTextNode(t)),i(a,u),r._.createTypeComponent(e,n,function(e){r._.children[t]=e,i(u,e.getDOM())})}}),a}var r=this,i=r._.appendChild;if(e){var a=document.createElement("table");a.className="object";var o=document.createElement("tbody");if(i(a,o),e.hasOwnProperty("properties"))for(var s in e.properties){var l=n(r._.schemaId+"."+s,s,r._.initialData?r._.initialData[s]:null);i(o,l)}if(e.patternProperties){var u=[],d=document.createElement("div");i(d,a);for(var p in e.patternProperties){var m=document.createElement("div");m.className="add-pattern-div";var f=document.createElement("button");if(f.setAttribute("type","button"),f.pattern=p,f.onclick=function(){var n=r.pattern,a=t(e.patternProperties[n],n);i(o,a)},1===Object.keys(e.patternProperties).length?i(f,document.createTextNode(c.i18n.getTranslation("addItem"))):i(f,document.createTextNode(c.i18n.getTranslation("addItem")+" /"+p+"/")),i(m,f,e),r._.initialData)for(var s in r._.initialData)if(!e.properties||!e.properties.hasOwnProperty(s)){var h=RegExp(p);if(-1!==s.search(h)&&-1===u.indexOf(s)){var l=t(e.patternProperties[p],p,r._.initialData[s]);i(o,l),u.push(s)}}i(d,m)}i(r.getDOM(),d)}else i(r.getDOM(),a)}},this.getData=function(){var e={},t=!1;for(var n in this._.children){var r=this._.children[n].getData();null!==r&&(t=!0,e[n]=r)}return t||this._.schema.required===!0?e:null}}function o(){this.render=function(e){function t(e,t){}function n(e){for(i._.children[0]&&(i._.children[0].dispose(),i._.children[0]=null);p.firstChild;)p.removeChild(p.firstChild);i._.createTypeComponent(e,i._.initialData,function(e){i._.children[0]=e,a(p,e.getDOM()),e.onchange=function(e){i._.notifyChanged(i._.schemaId),i.onchange(e)}})}function r(e,t){var n=function(r){t(r),i._.unRegisterSchemaListener(i._.schemaId+"."+e,n)};i._.registerSchemaListener(i._.schemaId+"."+e,n)}var i=this,a=i._.appendChild;i._.children=[null];var o=document.createElement("table"),s=document.createElement("tr"),c=document.createElement("tr"),l=document.createElement("td"),u=document.createElement("td");a(o,s),a(o,c),a(s,l),a(c,u);var d=document.createElement("select");a(l,d);var p=document.createElement("div");a(u,p),a(d,document.createElement("option"));for(var m,f=0;f<e.oneOf.length;f++)r(f,function(e){var r=document.createElement("option"),o=document.createTextNode(e.title?e.title:e.$id);r.value=f,a(r,o),a(d,r),"undefined"!=typeof i._.initialData&&0!==m&&t(i._.initialData,e)&&("undefined"==typeof m?(m=f+1,n(i._.schemaId+"."+f)):m=0,d.selectedIndex=m)});i._.initialData&&e.readOnly&&(d.disabled=!0),d.onchange=function(){n(i._.schemaId+"."+(d.selectedIndex-1))},a(i.getDOM(),o)},this.getSelectedSchema=function(){},this.getData=function(){return this._.children[0]}}function s(){this.render=function(e){function t(){var t;if("any"===e.type)t=document.createElement("textarea"),i&&(t.value=JSON.stringify(i,null,4),e.readOnly&&(t.disabled=!0));else if(e.media)t=document.createElement("input"),t.type="file",r(t,n);else if(e["enum"]){if(t=document.createElement("select"),!e.required){var n=document.createElement("option"),a=document.createTextNode("");n.value="",r(n,a),r(t,n)}for(var o=0,s=0;s<e["enum"].length;s++){var n=document.createElement("option"),a=document.createTextNode(e["enum"][s]);n.value=e["enum"][s],r(n,a),r(t,n),i&&e["enum"][s]===i&&(o=s,e.required||o++,e.readOnly&&(t.disabled=!0))}1===e["enum"].length?t.selectedIndex=1:t.selectedIndex=o}else if("boolean"===e.type)if(e.required)t=document.createElement("input"),t.type="checkbox",i===!0&&(t.checked=!0);else{t=document.createElement("select");var l=document.createElement("option"),u=document.createTextNode("");u.value="",r(l,u),r(t,l);var d=document.createElement("option"),p=document.createTextNode(c.i18n.getTranslation("true"));d.value="true",r(d,p),r(t,d);var m=document.createElement("option"),f=document.createTextNode(c.i18n.getTranslation("false"));m.value="false",r(m,f),r(t,m),i===!0?t.selectedIndex=1:i===!1&&(t.selectedIndex=2)}else{if(t=document.createElement("input"),"integer"===e.type||"number"===e.type)t.type="number",t.step="any","number"!=typeof i&&(i=null);else if("date-time"===e.format)try{t.type="datetime-local"}catch(h){t.type="text"}else"email"===e.format?t.type="email":"text"===e.format?t=document.createElement("textarea"):t.type="text";null!==i&&"undefined"!=typeof i&&(t.value=i,e.readOnly&&(t.disabled=!0))}return e.description&&(t.title=e.description,t.placeholder=e.description),t.setAttribute("autocorrect","off"),t}var n=this,r=n._.appendChild,i=n._.initialData;n._.input=t(),n._.input.onchange=function(e){n._.notifyChanged(n._.schemaId),n.onchange(e)},r(n._.dom,n._.input)},this.getData=function(){function e(e,t){if(!e)return null;if("function"==typeof t.getValue)return t.getValue();var n;return n=e["enum"]?t.options[t.selectedIndex].value:t.value,""===n?null:("integer"===e.type?(n=parseInt(n),isFinite(n)||(n=null)):"number"===e.type?(n=parseFloat(n),isFinite(n)||(n=null)):"boolean"===e.type?"input"===t.tagName.toLowerCase()?(n=t.checked,n||(n=!1)):"select"===t.tagName.toLowerCase()&&(n="true"===t.value?!0:"false"===t.value?!1:null):"any"===e.type&&n&&(n=JSON.parse(n)),n)}return e(this._.schema,this._.input)}}if(String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();(void 0===t||t>n.length)&&(t=n.length),t-=e.length;var r=n.indexOf(e,t);return-1!==r&&r===t}),String.prototype.includes||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)}),String.prototype.format||(String.prototype.format=function(){for(var e=this,t=0;t<arguments.length;t++){var n=new RegExp("\\{"+t+"\\}","gi");e=e.replace(n,arguments[t])}return e}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){function n(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}if(null==this)throw new TypeError('"this" is null or not defined');var r=Object(this),i=r.length>>>0;if(0===i)return!1;for(var a=0|t,o=Math.max(a>=0?a:i-Math.abs(a),0);i>o;){if(n(r[o],e))return!0;o++}return!1}}),"undefined"==typeof brutusin)window.brutusin=new Object;else if("object"!=typeof brutusin)throw"brutusin global variable already exists";var c=new Object;c.factories={schemaResolver:null,typeComponents:{string:null,object:null,array:null,"boolean":null,number:null,integer:null,any:null,oneOf:null}},brutusin["json-forms"]=c,c.createForm=function(t,n,r){return new e(t,n,r)},c.i18n=new t;var l={type:"any"};if(c.factories.schemaResolver=n,c.TypeComponent=r,i.prototype=new c.TypeComponent,c.factories.typeComponents.array=i,a.prototype=new c.TypeComponent,c.factories.typeComponents.object=a,o.prototype=new c.TypeComponent,c.factories.typeComponents.oneOf=o,s.prototype=new c.TypeComponent,c.factories.typeComponents.string=s,c.factories.typeComponents["boolean"]=s,c.factories.typeComponents.integer=s,c.factories.typeComponents.number=s,c.factories.typeComponents.any=s,"undefined"==typeof brutusin||"undefined"==typeof brutusin["json-forms"])throw new Error("brutusin-json-forms.js is required");!function(){var e=brutusin["json-forms"];e.i18n.setTranslations({validationError:"Validation error",required:"This field is **required**",invalidValue:"Invalid field value",addpropNameExistent:"This property is already present in the object",addpropNameRequired:"A name is required",minItems:"At least `{0}` items are required",maxItems:"At most `{0}` items are allowed",pattern:"Value does not match pattern: `{0}`",minLength:"Value must be **at least** `{0}` characters long",maxLength:"Value must be **at most** `{0}` characters long",multipleOf:"Value must be **multiple of** `{0}`",minimum:"Value must be **greater or equal than** `{0}`",exclusiveMinimum:"Value must be **greater than** `{0}`",maximum:"Value must be **lower or equal than** `{0}`",exclusiveMaximum:"Value must be **lower than** `{0}`",minProperties:"At least `{0}` properties are required",maxProperties:"At most `{0}` properties are allowed",uniqueItems:"Array items must be unique",addItem:"Add item","true":"True","false":"False"})}()}();