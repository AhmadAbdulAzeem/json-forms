!function(){"use strict";function e(e,t,r){function n(e,t,r){e.appendChild(t)}function i(){var e=document.createElement("form");return e.className="brutusin-form",e.onsubmit=function(e){return!1},e}function a(e){if(!s.factories.schemaResolver)throw"SchemaResolver factory not registered";var t=new s.factories.schemaResolver;return e&&e.customSchemaResolver&&(t.resolveSchemas=e.customSchemaResolver),t}function o(e){var t={};for(var r in s.factories.typeComponents){if(!s.factories.typeComponents[r])throw"TypeComponent factory not registered for type '"+r+"'";t[r]=s.factories.typeComponents[r]}return t}function c(e,t,r){var n=function(i){if(i&&i.type&&"null"!==i.type){if(!d.hasOwnProperty(i.type))throw"Component factory not found for schemas of type '"+i.type+"'";var a=new d[i.type];a.init(e,t,h),u.removeListener(e,n),r(a)}};u.addListener(e,n)}this.schema=e,this.initialData=t;var l;this.getData=function(){return l?l.getData():this.initialData};var u=a(r);u.init(this);var d=o(r),p=i();this.getDOM=function(){return p};var h={schemaResolver:u,createTypeComponent:c,appendChild:n};c("$",t,function(e){l=e,n(p,e.getDOM())})}function t(){this.translations={},this.setTranslations=function(e){if(!e)throw"A translation map is required";this.translations=e},this.getTranslation=function(e){return this.translations[e]?this.translations[e]:"{$"+e+"}"}}function r(){function e(e){return e}function t(e,t){for(var r in n)if(r.startsWith(e)&&!t.hasOwnProperty(r)){var a=i[r];if(a)for(var o=0;o<a.length;o++)a[o](null);delete n[r]}}function r(e,t,r){function n(e,t){if(e)if(t(e),e.hasOwnProperty("oneOf"))for(var r in e.oneOf)n(e.oneOf[r],t);else if(e.hasOwnProperty("$ref")){var i=d(e.$ref);n(i,t)}else if("object"===e.type){if(e.properties){e.hasOwnProperty("required")&&Array.isArray(e.required)&&(e.requiredProperties=e.required,delete e.required);for(var a in e.properties)n(e.properties[a],t)}if(e.patternProperties)for(var o in e.patternProperties){var s=e.patternProperties[o];(s.hasOwnProperty("type")||s.hasOwnProperty("$ref")||s.hasOwnProperty("oneOf"))&&n(e.patternProperties[o],t)}e.additionalProperties&&(e.additionalProperties.hasOwnProperty("type")||e.additionalProperties.hasOwnProperty("oneOf"))&&n(e.additionalProperties,t)}else"array"===e.type&&n(e.items,t)}function i(e){n(e,function(e){"object"===e.type&&e.properties&&e.hasOwnProperty("required")&&Array.isArray(e.required)&&(e.requiredProperties=e.required,delete e.required)})}function a(e){n(e,function(e){if("object"===e.type&&e.additionalProperties){e.hasOwnProperty("patternProperties")||(e.patternProperties={});var t=!1;for(var r in e.patternProperties)if(".*"===r){t=!0;break}t||(e.patternProperties[".*"]=e.additionalProperties,delete e.additionalProperties)}})}function o(e,t){function n(e,t){for(var r=0;r<e.length;r++)if(e[r]==t)return!0;return!1}var i=u(t);if(p[e]={id:e,schema:i,"static":!r},t){if(t.hasOwnProperty("oneOf")){i.oneOf=new Array,i.type="oneOf";for(var a in t.oneOf){var s=e+"."+a;i.oneOf[a]=s,o(s,t.oneOf[a])}}else if(t.hasOwnProperty("$ref")){var l=d(t.$ref);if(l){if(t.hasOwnProperty("title")||t.hasOwnProperty("description")){var m={};for(var f in l)m[f]=l[f];t.hasOwnProperty("title")&&(m.title=t.title),t.hasOwnProperty("description")&&(m.description=t.description),l=m}o(e,l)}}else if("object"===t.type){if(t.properties){i.properties={};for(var f in t.properties){var s=e+"."+f;i.properties[f]=s;var v=t.properties[f];t.requiredProperties&&(n(t.requiredProperties,f)?v.required=!0:v.required=!1),o(s,v)}}if(t.patternProperties){i.patternProperties={};for(var y in t.patternProperties){var g=e+"[/"+y+"/]";i.patternProperties[y]=g;var O=t.patternProperties[y];O.hasOwnProperty("type")||O.hasOwnProperty("$ref")||O.hasOwnProperty("oneOf")?o(g,t.patternProperties[y]):o(g,c)}}}else"array"===t.type&&(i.items=e+"[#]",o(i.items,t.items));if(t.hasOwnProperty("dependsOn")){null===t.dependsOn&&(t.dependsOn=["$"]);for(var b=new Array,a=0;a<t.dependsOn.length;a++)t.dependsOn[a]?t.dependsOn[a].startsWith("$")?b[a]=t.dependsOn[a]:e.endsWith("]")?b[a]=e+"."+t.dependsOn[a]:b[a]=e.substring(0,e.lastIndexOf("."))+"."+t.dependsOn[a]:b[a]="$";p[e].dependsOn=b;for(var a=0;a<b.length;a++){var w=h[b[a]];w||(w=new Array,h[b[a]]=w),w[w.length]=e}}}}function s(){function e(t,r,n){if(r.hasOwnProperty(n))throw"Schema dependency graph has cycles";if(r[n]=null,!t.hasOwnProperty(n)){t[n]=null;var i=h[n];if(i)for(var a=0;a<i.length;a++)e(t,r,i[a]);delete r[n]}}var t=new Object;for(var r in h)t.hasOwnProperty(r)||e(t,new Object,r)}function l(){for(var e in h){if(!p.hasOwnProperty(e))throw"Invalid schema id found in dependecies: "+e;p[e].dependedBy=h[e]}}function u(e){var t={};for(var r in e)"items"!==r&&"properties"!==r&&"additionalProperties"!==r&&("pattern"===r?t[r]=new RegExp(e[r]):t[r]=e[r]);return t}function d(e){var r=e.split("/"),n=t;for(var i in r)"0"!==i&&(n=n[r[i]]);return n}var p={},h={};return i(t),a(t),o(e,t),s(),l(),p}var n,i={};this.init=function(e){this.form=e,n=r("$",e.schema,!1)},this.notifyChanged=function(e){if(n.hasOwnProperty(e)){var t=n[e].dependedBy;if(!t)return;this.resolve(t,i)}},this.resolve=function(e,i){this.resolveSchemas(e,this.form.getData(),function(a){if(!a)throw"Couldn't resolve schema item '"+o+"'";for(var o in a)if(e.includes(o)&&(!n.hasOwnProperty(o)||JSON.stringify(n[o].schema)!==JSON.stringify(a[o]))){var s=r(o,a[o],!0);t(o,s);for(var c in s){n[c]=s[c];var l=i[c];if(l)for(var u=0;u<l.length;u++)l[u](s[c].schema)}}})},this.addListener=function(t,r){if(t=e(t),i.hasOwnProperty(t)?i[t].push(r):i[t]=[r],n.hasOwnProperty(t))if(n[t].dependsOn){var a={};a[t]=[r],this.resolve(t,a)}else r(n[t].schema);else;},this.removeListener=function(t,r){if(t=e(t),i.hasOwnProperty(t))for(var n=i[t],a=0;a<n.length;a++)if(n[a]===r){n.splice(a,1);break}},this.resolveSchemas=function(e,t,r){}}function n(){this.init=function(e,t,r){this._||(this._={},this._.dom=document.createElement("div"));var n=this;for(this._.children={},this._.schemaListeners=[],this._.schema=null,e&&(this.schemaId=e),"undefined"!=typeof t&&(this.initialData=t),r&&(this._.appendChild=r.appendChild,this._.createTypeComponent=r.createTypeComponent,this._.registerSchemaListener=function(e,t){n._.schemaListeners.push({schemaId:e,callback:t}),r.schemaResolver.addListener(e,t)},this._.unRegisterSchemaListener=function(e,t){for(var i,a=0;a<n._.schemaListeners.length;a++)if(i=n._.schemaListeners[a],i.schemaId===e&&i.callback===t){n._.schemaListeners.splice(a,1);break}r.schemaResolver.removeListener(e,t)},this._.notifyChanged=function(e){r.schemaResolver.notifyChanged(e)});this._.dom.firstChild;)this._.dom.removeChild(this._.dom.firstChild);this._.registerSchemaListener(this.schemaId,function(e){n._.schema?(n.dispose(),n.init()):(n._.schema=e,e&&n.render(e))})},this.render=function(e){},this.getDOM=function(){return this._.dom},this.getData=function(){},this.validate=function(){},this.onchange=function(){},this.dispose=function(){for(var e=this._.schemaListeners.length-1;e>=0;e--){var t=this._.schemaListeners[e];this._.unRegisterSchemaListener(t.schemaId,t.callback)}for(var r in this._.children)this._.children[r].dispose()}}function i(){this.render=function(e){function t(t,i){var a=document.createElement("tbody"),o=document.createElement("tr");o.className="item";var s=document.createElement("td");s.className="item-index";var c=document.createElement("td");c.className="item-action";var l=document.createElement("td");l.className="item-value";var u=document.createElement("button");u.setAttribute("type","button"),u.className="remove",e.readOnly===!0&&(u.disabled=!0),r(u,document.createTextNode("x"));var d,p=function(){for(var e=0;e<t.rows.length;e++){var r=t.rows[e];r.cells[0].innerHTML=e+1,r.index=e}};n._.createTypeComponent(e.items,i,function(e){d=e,n._.children.push(e),r(l,e.getDOM())}),u.onclick=function(){d&&(d.dispose(),d=null,o.parentNode.removeChild(o),n._.children.splice(o.index,1)),p()},r(c,u);var h=document.createTextNode(t.rows.length+1);r(s,h),r(o,s),r(o,c),r(o,l),r(a,o),r(t,a)}this._.children=[];var r=this._.appendChild;if(e){var n=this;this._.registerSchemaListener(this.schemaId,function(i){var a=document.createElement("div"),o=document.createElement("table");o.className="array";var c=document.createElement("button");if(e.readOnly&&(c.disabled=!0),c.setAttribute("type","button"),c.onclick=function(){t(o)},i.description&&(c.title=i.description),r(c,document.createTextNode(s.i18n.getTranslation("addItem"))),r(a,o),r(a,c),n.initialData&&n.initialData instanceof Array)for(var l=0;l<n.initialData.length;l++)t(o,n.initialData[l]);r(n.getDOM(),a)})}},this.getData=function(){var e=[];for(var t in this._.children){var r=this._.children[t].getData();null!==r&&e.push(r)}return e.length>0?e:null}}function a(){this.render=function(e){function t(e,t,r){var s=document.createElement("tr"),c=RegExp(t),l=function(u){for(;s.firstChild;)s.removeChild(s.firstChild);var d=null;if(d){var p=o._.children[d];p&&(p.dispose(),delete o._.children[d])}if(u&&u.type&&"null"!==u.type){var h,m=document.createElement("td");m.className="add-prop-name";var f=document.createElement("table"),v=document.createElement("tr"),y=document.createElement("td"),g=document.createElement("td"),O=document.createElement("td");O.className="prop-value";var b=document.createElement("input");b.type="text",b.placeholder="/"+t+"/",b.onchange=function(){if(d&&delete o._.children[d],b.value&&-1!==b.value.search(c)){for(var e=b.value,t=1;d!==e&&o._.children.hasOwnProperty(e);)e=b.value+"("+t+")",t++;d=e,b.value=d,o._.children[d]=h}};var w=document.createElement("button");w.setAttribute("type","button"),w.className="remove",n(w,document.createTextNode("x")),w.onclick=function(){d&&delete o._.children[d],h&&(h.dispose(),h=null,s.parentNode.removeChild(s)),o._.unRegisterSchemaListener(e,l)},n(y,b),n(g,w),n(v,y),n(v,g),n(f,v),n(m,f),n(s,m),n(s,O),n(a,s),n(i,a),o._.createTypeComponent(e,r,function(e){h=e,d&&(o._.children[d]=e),n(O,e.getDOM()),e.onchange=function(e){o._.notifyChanged(o.schemaId),o.onchange(e)}})}};return o._.registerSchemaListener(e,l),s}function r(e,t,r){var i=document.createElement("tr");return o._.registerSchemaListener(e,function(s){for(;i.firstChild;)i.removeChild(i.firstChild);var c=o._.children[t];if(c&&(c.dispose(),delete o._.children[t]),s&&s.type&&"null"!==s.type){var l=document.createElement("td");l.className="prop-name";var u=document.createElement("td");u.className="prop-value",n(a,i),n(i,l),n(l,document.createTextNode(t)),n(i,u),o._.createTypeComponent(e,r,function(e){o._.children[t]=e,n(u,e.getDOM())})}}),i}var n=this._.appendChild;if(e){var i=document.createElement("table");i.className="object";var a=document.createElement("tbody");n(i,a);var o=this;if(e.hasOwnProperty("properties"))for(var c in e.properties){var l=r(o.schemaId+"."+c,c,this.initialData?this.initialData[c]:null);n(a,l)}if(e.patternProperties){var u=[],d=document.createElement("div");n(d,i);for(var p in e.patternProperties){var h=document.createElement("div");h.className="add-pattern-div";var m=document.createElement("button");if(m.setAttribute("type","button"),m.pattern=p,m.onclick=function(){var r=this.pattern,i=t(e.patternProperties[r],r);n(a,i)},1===Object.keys(e.patternProperties).length?n(m,document.createTextNode(s.i18n.getTranslation("addItem"))):n(m,document.createTextNode(s.i18n.getTranslation("addItem")+" /"+p+"/")),n(h,m,e),this.initialData)for(var c in initialData)if(!e.properties||!e.properties.hasOwnProperty(c)){var f=RegExp(p);if(-1!==c.search(f)&&-1===u.indexOf(c)){var l=t(e.patternProperties[p],p,this.initialData[c]);n(a,l),u.push(c)}}n(d,h)}n(this.getDOM(),d)}else n(this.getDOM(),i)}},this.getData=function(){var e={},t=!1;for(var r in this._.children){var n=this._.children[r].getData();null!==n&&(t=!0,e[r]=n)}return t||this._.schema.required===!0?e:null}}function o(){this.render=function(e){function t(){var t;if("any"===e.type)t=document.createElement("textarea"),i&&(t.value=JSON.stringify(i,null,4),e.readOnly&&(t.disabled=!0));else if(e.media)t=document.createElement("input"),t.type="file",n(t,r);else if(e["enum"]){if(t=document.createElement("select"),!e.required){var r=document.createElement("option"),a=document.createTextNode("");r.value="",n(r,a),n(t,r)}for(var o=0,c=0;c<e["enum"].length;c++){var r=document.createElement("option"),a=document.createTextNode(e["enum"][c]);r.value=e["enum"][c],n(r,a),n(t,r),i&&e["enum"][c]===i&&(o=c,e.required||o++,e.readOnly&&(t.disabled=!0))}1===e["enum"].length?t.selectedIndex=1:t.selectedIndex=o}else if("boolean"===e.type)if(e.required)t=document.createElement("input"),t.type="checkbox",i===!0&&(t.checked=!0);else{t=document.createElement("select");var l=document.createElement("option"),u=document.createTextNode("");u.value="",n(l,u),n(t,l);var d=document.createElement("option"),p=document.createTextNode(s.i18n.getTranslation("true"));d.value="true",n(d,p),n(t,d);var h=document.createElement("option"),m=document.createTextNode(s.i18n.getTranslation("false"));h.value="false",n(h,m),n(t,h),i===!0?t.selectedIndex=1:i===!1&&(t.selectedIndex=2)}else{if(t=document.createElement("input"),"integer"===e.type||"number"===e.type)t.type="number",t.step="any","number"!=typeof i&&(i=null);else if("date-time"===e.format)try{t.type="datetime-local"}catch(f){t.type="text"}else"email"===e.format?t.type="email":"text"===e.format?t=document.createElement("textarea"):t.type="text";null!==i&&"undefined"!=typeof i&&(t.value=i,e.readOnly&&(t.disabled=!0))}return e.description&&(t.title=e.description,t.placeholder=e.description),t.setAttribute("autocorrect","off"),t}var r=this,n=this._.appendChild,i=this.initialData;this._.input=t(),this._.input.onchange=function(e){r._.notifyChanged(r.schemaId),r.onchange(e)},n(this._.dom,this._.input)},this.getData=function(){function e(e,t){if(!e)return null;if("function"==typeof t.getValue)return t.getValue();var r;return r=e["enum"]?t.options[t.selectedIndex].value:t.value,""===r?null:("integer"===e.type?(r=parseInt(r),isFinite(r)||(r=null)):"number"===e.type?(r=parseFloat(r),isFinite(r)||(r=null)):"boolean"===e.type?"input"===t.tagName.toLowerCase()?(r=t.checked,r||(r=!1)):"select"===t.tagName.toLowerCase()&&(r="true"===t.value?!0:"false"===t.value?!1:null):"any"===e.type&&r&&(r=JSON.parse(r)),r)}return e(this._.schema,this._.input)}}if(String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var r=this.toString();(void 0===t||t>r.length)&&(t=r.length),t-=e.length;var n=r.indexOf(e,t);return-1!==n&&n===t}),String.prototype.includes||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)}),String.prototype.format||(String.prototype.format=function(){for(var e=this,t=0;t<arguments.length;t++){var r=new RegExp("\\{"+t+"\\}","gi");e=e.replace(r,arguments[t])}return e}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){function r(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),i=n.length>>>0;if(0===i)return!1;for(var a=0|t,o=Math.max(a>=0?a:i-Math.abs(a),0);i>o;){if(r(n[o],e))return!0;o++}return!1}}),"undefined"==typeof brutusin)window.brutusin=new Object;else if("object"!=typeof brutusin)throw"brutusin global variable already exists";var s=new Object;s.factories={schemaResolver:null,typeComponents:{string:null,object:null,array:null,"boolean":null,number:null,integer:null,any:null}},brutusin["json-forms"]=s,s.createForm=function(t,r,n){return new e(t,r,n)},s.i18n=new t;var c={type:"any"};if(s.factories.schemaResolver=r,s.TypeComponent=n,i.prototype=new s.TypeComponent,s.factories.typeComponents.array=i,a.prototype=new s.TypeComponent,s.factories.typeComponents.object=a,o.prototype=new s.TypeComponent,s.factories.typeComponents.string=o,s.factories.typeComponents["boolean"]=o,s.factories.typeComponents.integer=o,s.factories.typeComponents.number=o,s.factories.typeComponents.any=o,"undefined"==typeof brutusin||"undefined"==typeof brutusin["json-forms"])throw new Error("brutusin-json-forms.js is required");!function(){var e=brutusin["json-forms"];e.i18n.setTranslations({validationError:"Validation error",required:"This field is **required**",invalidValue:"Invalid field value",addpropNameExistent:"This property is already present in the object",addpropNameRequired:"A name is required",minItems:"At least `{0}` items are required",maxItems:"At most `{0}` items are allowed",pattern:"Value does not match pattern: `{0}`",minLength:"Value must be **at least** `{0}` characters long",maxLength:"Value must be **at most** `{0}` characters long",multipleOf:"Value must be **multiple of** `{0}`",minimum:"Value must be **greater or equal than** `{0}`",exclusiveMinimum:"Value must be **greater than** `{0}`",maximum:"Value must be **lower or equal than** `{0}`",exclusiveMaximum:"Value must be **lower than** `{0}`",minProperties:"At least `{0}` properties are required",maxProperties:"At most `{0}` properties are allowed",uniqueItems:"Array items must be unique",addItem:"Add item","true":"True","false":"False"})}()}();