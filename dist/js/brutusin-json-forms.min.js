!function(){"use strict";function BrutusinForm(e,t,r){function n(e,t,r){e.appendChild(t)}function i(){var e=document.createElement("form");return e.className="brutusin-form",e.onsubmit=function(e){return!1},e}function o(e){if(!BrutusinForms.factories.schemaResolver)throw"SchemaResolver factory not registered";var t=new BrutusinForms.factories.schemaResolver;return e&&e.customSchemaResolver&&(t.resolveSchemas=e.customSchemaResolver),t}function a(e){var t={};for(var r in BrutusinForms.factories.typeComponents){if(!BrutusinForms.factories.typeComponents[r])throw"TypeComponent factory not registered for type '"+r+"'";t[r]=BrutusinForms.factories.typeComponents[r]}return t}function s(e,t,r){var n=function(i){if(i&&i.type&&"null"!==i.type){if(!p.hasOwnProperty(i.type))throw"Component factory not found for schemas of type '"+i.type+"'";var o=new p[i.type];o.init(e,t,m),u.removeListener(e,n),r(o)}};u.addListener(e,n)}this.schema=e,this.initialData=t;var u=o(r);u.init(this);var l,p=a(r),c=i(),m={schemaResolver:u,createTypeComponent:s,appendChild:n};s("$",t,function(e){l=e,n(c,e.getDOM())}),this.getData=function(){return l.getData()},this.getDOM=function(){return c}}function I18n(){this.translations={},this.setTranslations=function(e){if(!e)throw"A translation map is required";this.translations=e},this.getTranslation=function(e){return this.translations[e]?this.translations[e]:"{$"+e+"}"}}function SchemaResolver(){function e(e){return e}function t(e,t){for(var r in n)if(r.startsWith(e)&&!t.hasOwnProperty(r)){var o=i[r];if(o)for(var a=0;a<o.length;a++)o[a](null);delete n[r]}}function r(e,t,r){function n(e,t){if(e)if(t(e),e.hasOwnProperty("oneOf"))for(var r in e.oneOf)n(e.oneOf[r],t);else if(e.hasOwnProperty("$ref")){var i=p(e.$ref);n(i,t)}else if("object"===e.type){if(e.properties){e.hasOwnProperty("required")&&Array.isArray(e.required)&&(e.requiredProperties=e.required,delete e.required);for(var o in e.properties)n(e.properties[o],t)}if(e.patternProperties)for(var a in e.patternProperties){var s=e.patternProperties[a];(s.hasOwnProperty("type")||s.hasOwnProperty("$ref")||s.hasOwnProperty("oneOf"))&&n(e.patternProperties[a],t)}e.additionalProperties&&(e.additionalProperties.hasOwnProperty("type")||e.additionalProperties.hasOwnProperty("oneOf"))&&n(e.additionalProperties,t)}else"array"===e.type&&n(e.items,t)}function i(e){n(e,function(e){"object"===e.type&&e.properties&&e.hasOwnProperty("required")&&Array.isArray(e.required)&&(e.requiredProperties=e.required,delete e.required)})}function o(e){n(e,function(e){if("object"===e.type&&e.additionalProperties){e.hasOwnProperty("patternProperties")||(e.patternProperties={});var t=!1;for(var r in e.patternProperties)if(".*"===r){t=!0;break}t||(e.patternProperties[".*"]=e.additionalProperties,delete e.additionalProperties)}})}function a(e,t){var n=l(t);if(c[e]={id:e,schema:n,"static":!r},t){if(t.hasOwnProperty("oneOf")){n.oneOf=new Array,n.type="oneOf";for(var i in t.oneOf){var o=e+"."+i;n.oneOf[i]=o,a(o,t.oneOf[i])}}else if(t.hasOwnProperty("$ref")){var s=p(t.$ref);if(s){if(t.hasOwnProperty("title")||t.hasOwnProperty("description")){var u={};for(var d in s)u[d]=s[d];t.hasOwnProperty("title")&&(u.title=t.title),t.hasOwnProperty("description")&&(u.description=t.description),s=u}a(e,s)}}else if("object"===t.type){if(t.properties){n.properties={};for(var d in t.properties){var o=e+"."+d;n.properties[d]=o;var f=t.properties[d];t.requiredProperties&&(containsStr(t.requiredProperties,d)?f.required=!0:f.required=!1),a(o,f)}}if(t.patternProperties){n.patternProperties={};for(var h in t.patternProperties){var v=e+"[/"+h+"/]";n.patternProperties[h]=v;var y=t.patternProperties[h];y.hasOwnProperty("type")||y.hasOwnProperty("$ref")||y.hasOwnProperty("oneOf")?a(v,t.patternProperties[h]):a(v,SCHEMA_ANY)}}}else"array"===t.type&&(n.items=e+"[#]",a(n.items,t.items));if(t.hasOwnProperty("dependsOn")){null===t.dependsOn&&(t.dependsOn=["$"]);for(var O=new Array,i=0;i<t.dependsOn.length;i++)t.dependsOn[i]?t.dependsOn[i].startsWith("$")?O[i]=t.dependsOn[i]:e.endsWith("]")?O[i]=e+"."+t.dependsOn[i]:O[i]=e.substring(0,e.lastIndexOf("."))+"."+t.dependsOn[i]:O[i]="$";c[e].dependsOn=O;for(var i=0;i<O.length;i++){var g=m[O[i]];g||(g=new Array,m[O[i]]=g),g[g.length]=e}}}}function s(){function e(t,r,n){if(r.hasOwnProperty(n))throw"Schema dependency graph has cycles";if(r[n]=null,!t.hasOwnProperty(n)){t[n]=null;var i=m[n];if(i)for(var o=0;o<i.length;o++)e(t,r,i[o]);delete r[n]}}var t=new Object;for(var r in m)t.hasOwnProperty(r)||e(t,new Object,r)}function u(){for(var e in m){if(!c.hasOwnProperty(e))throw"Invalid schema id found in dependecies: "+e;c[e].dependedBy=m[e]}}function l(e){var t={};for(var r in e)"items"!==r&&"properties"!==r&&"additionalProperties"!==r&&("pattern"===r?t[r]=new RegExp(e[r]):t[r]=e[r]);return t}function p(e){var r=e.split("/"),n=t;for(var i in r)"0"!==i&&(n=n[r[i]]);return n}var c={},m={};return i(t),o(t),a(e,t),s(),u(),c}var n,i={};this.init=function(e){this.form=e,n=r("$",e.schema,!1)},this.notifyChanged=function(e){var t=n[e].dependedBy;t&&this.resolve(t)},this.resolve=function(e){this.resolveSchemas(e,this.form.getData(),function(o){if(!o)throw"Couldn't resolve schema item '"+a+"'";for(var a in o)if(e.includes(a)&&(!n.hasOwnProperty(a)||JSON.stringify(n[a].schema)!==JSON.stringify(o[a]))){var s=r(a,o[a],!0);t(a,s);for(var u in s){n[u]=s[u];var l=i[u];if(l)for(var p=0;p<l.length;p++)l[p](s[u].schema)}}})},this.addListener=function(t,r){return t=e(t),i.hasOwnProperty(t)?i[t].push(r):i[t]=[r],n.hasOwnProperty(t)&&!n[t].dependsOn?void r(n[t].schema):void 0},this.removeListener=function(t,r){if(t=e(t),i.hasOwnProperty(t))for(var n=i[t],o=0;o<n.length;o++)if(n[o]===r){n.splice(o,1);break}},this.resolveSchemas=function(e,t,r){}}function TypeComponent(){this.componentFunctions={removeAllChildren:function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}},this.init=function(e,t,r){function n(){i.componentFunctions.removeAllChildren(i.dom),i.children={}}this.schemaId=e,this.initialData=t,this.formFunctions=r,this.dom=document.createElement("div");var i=this;this.schemaListener=function(e){i.schema=e,n(),e&&i.render(e)},this.formFunctions.schemaResolver.addListener(this.schemaId,this.schemaListener)},this.render=function(e){},this.getDOM=function(){return this.dom},this.getData=function(){},this.validate=function(){},this.onchange=function(){},this.dispose=function(){this.formFunctions.schemaResolver.removeListener(this.schemaId,this.schemaListener)}}function ObjectComponent(){this.render=function(e){function t(e,t,r){var s=document.createElement("tr"),u=RegExp(t);return a.formFunctions.schemaResolver.addListener(e,function(l){a.componentFunctions.removeAllChildren(s);var p=null;if(p){var c=a.children[p];c&&(c.dispose(),delete a.children[p])}if(l&&l.type&&"null"!==l.type){var m,d=document.createElement("td");d.className="add-prop-name";var f=document.createElement("table"),h=document.createElement("tr"),v=document.createElement("td"),y=document.createElement("td"),O=document.createElement("td");O.className="prop-value";var g=document.createElement("input");g.type="text",g.placeholder="/"+t+"/",g.onchange=function(){if(p&&delete a.children[p],g.value&&-1!==g.value.search(u)){for(var e=g.value,t=1;p!==e&&a.children.hasOwnProperty(e);)e=g.value+"("+t+")",t++;p=e,g.value=p,a.children[p]=m}};var b=document.createElement("button");b.setAttribute("type","button"),b.className="remove",n(b,document.createTextNode("x")),b.onclick=function(){p&&delete a.children[p],m&&(m.dispose(),m=null,s.parentNode.removeChild(s))},n(v,g),n(y,b),n(h,v),n(h,y),n(f,h),n(d,f),n(s,d),n(s,O),n(o,s),n(i,o),a.formFunctions.createTypeComponent(e,r,function(e){m=e,p&&(a.children[p]=e),n(O,e.getDOM())})}}),s}function r(e,t,r){var i=document.createElement("tr");return a.formFunctions.schemaResolver.addListener(e,function(s){a.componentFunctions.removeAllChildren(i);var u=a.children[t];if(u&&(u.dispose(),delete a.children[t]),s&&s.type&&"null"!==s.type){var l=document.createElement("td");l.className="prop-name";var p=document.createElement("td");p.className="prop-value",n(o,i),n(i,l),n(l,document.createTextNode(t)),n(i,p),a.formFunctions.createTypeComponent(e,r,function(e){a.children[t]=e,n(p,e.getDOM())})}}),i}var n=this.formFunctions.appendChild;if(this.componentFunctions.removeAllChildren(this.dom),e){var i=document.createElement("table");i.className="object";var o=document.createElement("tbody");n(i,o);var a=this;if(e.hasOwnProperty("properties"))for(var s in e.properties){var u=r(a.schemaId+"."+s,s,this.initialData?this.initialData[s]:null);n(o,u)}if(e.patternProperties){var l=[],p=document.createElement("div");n(p,i);for(var c in e.patternProperties){var m=document.createElement("div");m.className="add-pattern-div";var d=document.createElement("button");if(d.setAttribute("type","button"),d.pattern=c,d.onclick=function(){var r=this.pattern,i=t(e.patternProperties[r],r);n(o,i)},1===Object.keys(e.patternProperties).length?n(d,document.createTextNode(BrutusinForms.i18n.getTranslation("addItem"))):n(d,document.createTextNode(BrutusinForms.i18n.getTranslation("addItem")+" /"+c+"/")),n(m,d,e),this.initialData)for(var s in initialData)if(!e.properties||!e.properties.hasOwnProperty(s)){var f=RegExp(c);if(-1!==s.search(f)&&-1===l.indexOf(s)){var u=t(e.patternProperties[c],c,this.initialData[s]);n(o,u),l.push(s)}}n(p,m)}n(this.dom,p)}else n(this.dom,i)}},this.getData=function(){var e={};for(var t in this.children)e[t]=this.children[t].getData();return e}}function SimpleComponent(){this.render=function(e){function t(){var t;if("any"===e.type)t=document.createElement("textarea"),i&&(t.value=JSON.stringify(i,null,4),e.readOnly&&(t.disabled=!0));else if(e.media)t=document.createElement("input"),t.type="file",n(t,r);else if(e["enum"]){if(t=document.createElement("select"),!e.required){var r=document.createElement("option"),o=document.createTextNode("");r.value="",n(r,o),n(t,r)}for(var a=0,s=0;s<e["enum"].length;s++){var r=document.createElement("option"),o=document.createTextNode(e["enum"][s]);r.value=e["enum"][s],n(r,o),n(t,r),i&&e["enum"][s]===i&&(a=s,e.required||a++,e.readOnly&&(t.disabled=!0))}1===e["enum"].length?t.selectedIndex=1:t.selectedIndex=a}else if("boolean"===e.type)if(e.required)t=document.createElement("input"),t.type="checkbox",i===!0&&(t.checked=!0);else{t=document.createElement("select");var u=document.createElement("option"),l=document.createTextNode("");l.value="",n(u,l),n(t,u);var p=document.createElement("option"),c=document.createTextNode(BrutusinForms.i18n.getTranslation("true"));p.value="true",n(p,c),n(t,p);var m=document.createElement("option"),d=document.createTextNode(BrutusinForms.i18n.getTranslation("false"));m.value="false",n(m,d),n(t,m),i===!0?t.selectedIndex=1:i===!1&&(t.selectedIndex=2)}else{if(t=document.createElement("input"),"integer"===e.type||"number"===e.type)t.type="number",t.step="any","number"!=typeof i&&(i=null);else if("date-time"===e.format)try{t.type="datetime-local"}catch(f){t.type="text"}else"email"===e.format?t.type="email":"text"===e.format?t=document.createElement("textarea"):t.type="text";null!==i&&"undefined"!=typeof i&&(t.value=i,e.readOnly&&(t.disabled=!0))}return e.description&&(t.title=e.description,t.placeholder=e.description),t.setAttribute("autocorrect","off"),t}var r=this,n=this.formFunctions.appendChild,i=this.initialData;this.input=t(),this.input.onchange=function(e){r.formFunctions.schemaResolver.notifyChanged(r.schemaId),r.onchange(e)},this.componentFunctions.removeAllChildren(this.dom),n(this.dom,this.input)},this.getData=function(){function getValue(schema,input){if(!schema)return null;if("function"==typeof input.getValue)return input.getValue();var value;return value=schema["enum"]?input.options[input.selectedIndex].value:input.value,""===value?null:("integer"===schema.type?(value=parseInt(value),isFinite(value)||(value=null)):"number"===schema.type?(value=parseFloat(value),isFinite(value)||(value=null)):"boolean"===schema.type?"input"===input.tagName.toLowerCase()?(value=input.checked,value||(value=!1)):"select"===input.tagName.toLowerCase()&&(value="true"===input.value?!0:"false"===input.value?!1:null):"any"===schema.type&&value&&eval("value="+value),value)}return getValue(this.schema,this.input)}}if(String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var r=this.toString();(void 0===t||t>r.length)&&(t=r.length),t-=e.length;var n=r.indexOf(e,t);return-1!==n&&n===t}),String.prototype.includes||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)}),String.prototype.format||(String.prototype.format=function(){for(var e=this,t=0;t<arguments.length;t++){var r=new RegExp("\\{"+t+"\\}","gi");e=e.replace(r,arguments[t])}return e}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){function r(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),i=n.length>>>0;if(0===i)return!1;for(var o=0|t,a=Math.max(o>=0?o:i-Math.abs(o),0);i>a;){if(r(n[a],e))return!0;a++}return!1}}),"undefined"==typeof brutusin)window.brutusin=new Object;else if("object"!=typeof brutusin)throw"brutusin global variable already exists";var BrutusinForms=new Object;BrutusinForms.factories={schemaResolver:null,typeComponents:{string:null,object:null,"boolean":null,number:null,integer:null,any:null}},brutusin["json-forms"]=BrutusinForms,BrutusinForms.createForm=function(e,t,r){return new BrutusinForm(e,t,r)},BrutusinForms.i18n=new I18n;var SCHEMA_ANY={type:"any"};if(BrutusinForms.factories.schemaResolver=SchemaResolver,BrutusinForms.TypeComponent=TypeComponent,ObjectComponent.prototype=new BrutusinForms.TypeComponent,BrutusinForms.factories.typeComponents.object=ObjectComponent,SimpleComponent.prototype=new BrutusinForms.TypeComponent,BrutusinForms.factories.typeComponents.string=SimpleComponent,BrutusinForms.factories.typeComponents["boolean"]=SimpleComponent,BrutusinForms.factories.typeComponents.integer=SimpleComponent,BrutusinForms.factories.typeComponents.number=SimpleComponent,BrutusinForms.factories.typeComponents.any=SimpleComponent,"undefined"==typeof brutusin||"undefined"==typeof brutusin["json-forms"])throw new Error("brutusin-json-forms.js is required");!function(){var e=brutusin["json-forms"];e.i18n.setTranslations({validationError:"Validation error",required:"This field is **required**",invalidValue:"Invalid field value",addpropNameExistent:"This property is already present in the object",addpropNameRequired:"A name is required",minItems:"At least `{0}` items are required",maxItems:"At most `{0}` items are allowed",pattern:"Value does not match pattern: `{0}`",minLength:"Value must be **at least** `{0}` characters long",maxLength:"Value must be **at most** `{0}` characters long",multipleOf:"Value must be **multiple of** `{0}`",minimum:"Value must be **greater or equal than** `{0}`",exclusiveMinimum:"Value must be **greater than** `{0}`",maximum:"Value must be **lower or equal than** `{0}`",exclusiveMaximum:"Value must be **lower than** `{0}`",minProperties:"At least `{0}` properties are required",maxProperties:"At most `{0}` properties are allowed",uniqueItems:"Array items must be unique",addItem:"Add item","true":"True","false":"False"})}()}();